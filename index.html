<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Scrape raw or agreggated data for Maturita and JPZ exams by CZVV • cermine</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Scrape raw or agreggated data for Maturita and JPZ exams by CZVV">
<meta name="description" content="CZVV neither publishes a REST API nor provides exam data in easy-to-process JSON or XML formats. Instead, the data are published in separate XLSX files that are difficult to access programmatically because the links are dynamically generated by an ASP.NET server. This package provides a simple R API that allows you to gather links to all available exam data files and returns them in a tidy table.">
<meta property="og:description" content="CZVV neither publishes a REST API nor provides exam data in easy-to-process JSON or XML formats. Instead, the data are published in separate XLSX files that are difficult to access programmatically because the links are dynamically generated by an ASP.NET server. This package provides a simple R API that allows you to gather links to all available exam data files and returns them in a tidy table.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cermine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/netique/cermine/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="cermine">cermine<a class="anchor" aria-label="anchor" href="#cermine"></a>
</h1></div>
<!-- badges: start -->

<p>CZVV neither publishes a REST API nor provides exam data in easy-to-process JSON or XML formats. Instead, the data are published in separate XLSX files that are difficult to access programmatically because the links are dynamically generated by an ASP.NET server. This package provides a simple R API that allows you to gather links to all available exam data files and returns them in a tidy table.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of {cermine} like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"netique/cermine"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<p>Say we want to download all item-level “Maturita” data for 2024. First, we need to load {cermine} and {tidyverse} packages:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/netique/cermine" class="external-link">cermine</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>Then we can get the list of individual exam events. <strong>Note that all HTTP requests are cached for the current R session</strong>, so you don’t have to worry much about hammering the server. If you believe that the data have changed, you can force a refresh by setting the <code>force</code> argument to <code>TRUE</code> or simply restart your R session.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exams</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_exam_events.html">get_exam_events</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Extracting exam events...✔ Done extracting exam events... [5ms]</span></span>
<span></span>
<span><span class="va">exams</span></span>
<span><span class="co">#&gt; # A tibble: 27 × 2</span></span>
<span><span class="co">#&gt;    project           year                        </span></span>
<span><span class="co">#&gt;    &lt;chr&gt;             &lt;chr&gt;                       </span></span>
<span><span class="co">#&gt;  1 Maturitní zkoušky 2024 - podzim               </span></span>
<span><span class="co">#&gt;  2 Maturitní zkoušky 2024 - Jaro                 </span></span>
<span><span class="co">#&gt;  3 Maturitní zkoušky 2023 - Podzim               </span></span>
<span><span class="co">#&gt;  4 Maturitní zkoušky 2023 - Jaro                 </span></span>
<span><span class="co">#&gt;  5 Maturitní zkoušky 2022 - Podzim               </span></span>
<span><span class="co">#&gt;  6 Maturitní zkoušky 2022 - Jaro                 </span></span>
<span><span class="co">#&gt;  7 Maturitní zkoušky 2021 - Podzim               </span></span>
<span><span class="co">#&gt;  8 Maturitní zkoušky 2021 - Jaro mimořádný termín</span></span>
<span><span class="co">#&gt;  9 Maturitní zkoušky 2021 - Jaro                 </span></span>
<span><span class="co">#&gt; 10 Maturitní zkoušky 2020 - Podzim               </span></span>
<span><span class="co">#&gt; # ℹ 17 more rows</span></span></code></pre></div>
<p>Now we can filter out the entries we are interested in. Because the year column can contain the season besides the year itself, we need to use the <code>str_detect()</code> function from the {stringr} package to catch any year that <em>contains</em> “2024”. But don’t worry, as the <code><a href="reference/mine_links.html">mine_links()</a></code> function will tell you that you’ve provided an option that is not available.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exams_filtered</span> <span class="op">&lt;-</span> <span class="va">exams</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">project</span> <span class="op">==</span> <span class="st">"Maturitní zkoušky"</span>, <span class="fu">str_detect</span><span class="op">(</span><span class="va">year</span>, <span class="st">"2024"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we can mine the links to the data files. This may take a while, as the function has to “submit” the ASP.NET forms to obtain HTTP response with link-populated HTMLs from the server. Provide the <code>projects</code> and <code>years</code> arguments with the columns from the <code>exams_filtered</code> tibble (there is no need to provide only unique values, so you can use the column as is). The <code>data_type</code> argument is set to “item” only. The function will return a tibble with the project, year, data type, data file name, and the associated link. Progress bar will show up if the operation is expected to take longer than a couple of seconds.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">links</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mine_links.html">mine_links</a></span><span class="op">(</span></span>
<span>  projects <span class="op">=</span> <span class="va">exams_filtered</span><span class="op">$</span><span class="va">project</span>,</span>
<span>  years <span class="op">=</span> <span class="va">exams_filtered</span><span class="op">$</span><span class="va">year</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"item"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">links</span></span>
<span><span class="co">#&gt; # A tibble: 13 × 5</span></span>
<span><span class="co">#&gt;    project           year          data_type file_name                  file_url</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;             &lt;fct&gt;         &lt;fct&gt;     &lt;chr&gt;                      &lt;chr&gt;   </span></span>
<span><span class="co">#&gt;  1 Maturitní zkoušky 2024 - podzim item      MZ2024p_AJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  2 Maturitní zkoušky 2024 - podzim item      MZ2024p_CJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  3 Maturitní zkoušky 2024 - podzim item      MZ2024p_MA_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  4 Maturitní zkoušky 2024 - podzim item      MZ2024p_NJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  5 Maturitní zkoušky 2024 - podzim item      MZ2024p_RJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  6 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_AJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  7 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_CJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  8 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_FJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt;  9 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_MA_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt; 10 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_MX_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt; 11 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_NJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt; 12 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_RJ_polozkova_data… https:/…</span></span>
<span><span class="co">#&gt; 13 Maturitní zkoušky 2024 - Jaro   item      MZ2024j_SJ_polozkova_data… https:/…</span></span></code></pre></div>
<p>To download the files, you can use <code><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file()</a></code> function as follows. Because the files can be large, it is recommended to set the timeout to a higher value than the default 60 seconds. The <code><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file()</a></code> function is not vectorized, so we have to use <code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">purrr::map2()</a></code> to iterate over the file names and URLs. You can opt for a simple for loop as well.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># optionally set the timeout to 10 minutes, if the download fails</span></span>
<span><span class="co"># options(timeout = 60 * 10)</span></span>
<span></span>
<span><span class="fu">map2</span><span class="op">(</span></span>
<span>  <span class="va">links</span><span class="op">$</span><span class="va">file_name</span>, <span class="va">links</span><span class="op">$</span><span class="va">file_url</span>,</span>
<span>  \<span class="op">(</span><span class="va">file_name</span>, <span class="va">file_url</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">file_url</span>, <span class="va">file_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Et voilà! You have downloaded the data files to your current working directory. The files are named according to the <code>file_name</code> column in the <code>links</code> tibble. You can now read them into R using the <code>readxl</code> package or any other package that can read XLSX files.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/netique/cermine/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/netique/cermine/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>AGPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cermine</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jan Netik <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3888-3203" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=cermine" class="external-link"><img src="https://www.r-pkg.org/badges/version/cermine" alt="CRAN status"></a></li>
<li><a href="https://github.com/netique/cermine/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/netique/cermine/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jan Netik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
